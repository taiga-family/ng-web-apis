import{b as V}from"./chunk-Y7XNAN3T.js";import{$ as W,D as g,Db as n,Fb as u,G as w,Gb as p,Kc as l,L as C,Q as F,Yc as h,Zc as U,_c as _,ea as S,gd as q,ka as E,na as v,pa as o,u as I}from"./chunk-KG2R5REB.js";import{g as T}from"./chunk-GAL4ENT6.js";var s=new v("[WA_AUDIO_CONTEXT]",{factory:()=>new AudioContext});var c=new v("[WA_AUDIO_NODE]",{factory:()=>null});function A(t){return{provide:c,useExisting:t}}function f(t,e){t&&e&&t.connect(e)}var k=class t extends AnalyserNode{quiet=V(g(100).pipe(I(()=>new Float32Array(this.fftSize)),S(e=>this.getFloatTimeDomainData(e)),I(e=>this.isSilent(e)),F(),W(e=>e),C(5e3),w(e=>e)));constructor(){super(o(s),{fftSize:256}),f(o(c),this),this.connect(this.context.destination)}ngOnDestroy(){this.disconnect()}isSilent(e){return Math.abs(e.reduce((i,r)=>i+r,0))<.001}static \u0275fac=function(i){return new(i||t)};static \u0275dir=n({type:t,selectors:[["","waAudioDestinationNode",""]],outputs:{quiet:"quiet"},exportAs:["AudioNode"],features:[u]})};var j=class t extends GainNode{constructor(){super(o(s)),f(o(c),this)}set waOutput(e){this.disconnect(),f(this,e)}ngOnDestroy(){this.disconnect()}static \u0275fac=function(i){return new(i||t)};static \u0275dir=n({type:t,selectors:[["","waOutput",""]],inputs:{waOutput:"waOutput"},features:[u]})};var b=class t{context=o(s);cache=new Map;fetch(e){return T(this,null,function*(){return new Promise((i,r)=>{if(this.cache.has(e)){i(this.cache.get(e));return}let a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onerror=r,a.onabort=r,a.onload=()=>{this.context.decodeAudioData(a.response,P=>{this.cache.set(e,P),i(P)},r)},a.send()})})}static \u0275fac=function(i){return new(i||t)};static \u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})};var y=class t{node=o(c,{self:!0});parent=o(c,{skipSelf:!0});ngOnInit(){f(this.parent,this.node)}ngOnDestroy(){this.node?.disconnect()}static \u0275fac=function(i){return new(i||t)};static \u0275dir=n({type:t})};var H=class t extends ConvolverNode{service=o(b);constructor(){super(o(s))}set bufferSetter(e){typeof e=="string"?this.service.fetch(e).then(i=>{this.buffer=i}):this.buffer=e}static \u0275fac=function(i){return new(i||t)};static \u0275dir=n({type:t,selectors:[["","waConvolverNode",""]],inputs:{bufferSetter:[0,"buffer","bufferSetter"],normalize:"normalize",channelCount:"channelCount",channelCountMode:"channelCountMode",channelInterpretation:"channelInterpretation"},exportAs:["AudioNode"],features:[l([A(t)]),p([y]),u]})};function D(t,e,i=0){if(e=typeof e=="string"?Number.parseFloat(e):e,t.cancelAndHoldAtTime?t.cancelAndHoldAtTime(i):(t.cancelScheduledValues(i),t.setValueAtTime(d(t.value),i)),typeof e=="number"){t.setValueAtTime(d(e),i);return}if(e instanceof Array){G(t,e,i);return}if(!("mode"in e)){t.setValueCurveAtTime(e.value,i,e.duration);return}t.setValueAtTime(d(t.value),i),X(t,e,i)}function G(t,e,i){e.forEach(r=>{"mode"in r?X(t,r,i):t.setValueCurveAtTime(r.value,i,r.duration),i+=r.duration})}function X(t,{value:e,mode:i,duration:r},a){switch(i){case"exponential":e<0||e*t.value<0?t.linearRampToValueAtTime(d(e),a+r):t.exponentialRampToValueAtTime(d(e),a+r),t.setValueAtTime(d(e),a+r);break;case"instant":t.setValueAtTime(d(e),a),t.setValueAtTime(d(e),a+r);break;case"linear":t.linearRampToValueAtTime(d(e),a+r);break}}function d(t){return t||1e-8}function O(t,e){let i=parseFloat(t||"");return Number.isNaN(i)?e:i}var B=class t extends GainNode{constructor(){let e=o(new h("gain"),{optional:!0});super(o(s),{gain:O(e,1)})}set gainSetter(e){D(this.gain,e,this.context.currentTime)}static \u0275fac=function(i){return new(i||t)};static \u0275dir=n({type:t,selectors:[["","waGainNode",""]],inputs:{gainSetter:[0,"gain","gainSetter"],channelCount:"channelCount",channelCountMode:"channelCountMode",channelInterpretation:"channelInterpretation"},exportAs:["AudioNode"],features:[l([A(t)]),p([y]),u]})};var x=class t{node=o(c,{self:!0});autoplay=_(!1,{transform:q});ended=U();ngOnInit(){this.node.onended=()=>this.ended.emit(),this.autoplay()&&this.node.start()}ngOnDestroy(){try{this.node.stop()}catch{}this.node.disconnect()}static \u0275fac=function(i){return new(i||t)};static \u0275dir=n({type:t,inputs:{autoplay:[1,"autoplay"]},outputs:{ended:"ended"}})},N=class t{static \u0275fac=function(i){return new(i||t)};static \u0275dir=n({type:t,features:[p([{directive:x,inputs:["autoplay","autoplay"],outputs:["ended","ended"]}])]})};var z=class t extends OscillatorNode{constructor(){let e=o(new h("detune"),{optional:!0}),i=o(new h("frequency"),{optional:!0});super(o(s),{detune:O(e,0),frequency:O(i,440)})}set periodicWave(e){this.setPeriodicWave(e)}set detuneSetter(e){D(this.detune,e,this.context.currentTime)}set frequencySetter(e){D(this.frequency,e,this.context.currentTime)}static \u0275fac=function(i){return new(i||t)};static \u0275dir=n({type:t,selectors:[["","waOscillatorNode",""]],inputs:{detuneSetter:[0,"detune","detuneSetter"],frequencySetter:[0,"frequency","frequencySetter"],type:"type",channelCount:"channelCount",channelCountMode:"channelCountMode",channelInterpretation:"channelInterpretation",periodicWave:"periodicWave"},exportAs:["AudioNode"],features:[l([A(t)]),p([N]),u]})};export{s as a,A as b,k as c,D as d,y as e,j as f,N as g,O as h,b as i,H as j,B as k,z as l};
